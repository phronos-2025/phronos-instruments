---
/**
 * Landing Page Navigation
 * Adapted from phronos-site Nav.astro for instruments domain (dark mode)
 */

import { PhronosLogo } from '../ui/PhronosLogo';
import { NavAuthButton } from '../auth/NavAuthButton';
---

<nav class="nav">
  <a href="https://phronos.org" class="nav-brand">
    <PhronosLogo size={31} theme="dark" client:only="react" />
    <span class="nav-wordmark">Phronos</span>
  </a>

  <ul class="nav-links">
    <li><a href="https://phronos.org/dispatches" class="nav-link">Dispatches</a></li>
    <li><span class="nav-link nav-link-disabled">Library</span></li>
    <li><a href="https://phronos.org/methods" class="nav-link">Methods</a></li>
    <li><a href="/" class="nav-link nav-link-active">Instruments</a></li>
  </ul>

  <NavAuthButton client:load variant="desktop" />

  <button class="nav-hamburger" aria-label="Open menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
</nav>

<!-- Mobile Menu -->
<div class="nav-mobile-menu">
  <div class="nav-mobile-header">
    <a href="https://phronos.org" class="nav-brand">
      <PhronosLogo size={31} theme="dark" client:only="react" />
      <span class="nav-wordmark">Phronos</span>
    </a>
    <button class="nav-mobile-close" aria-label="Close menu"></button>
  </div>

  <div class="nav-mobile-links">
    <a href="https://phronos.org/dispatches" class="nav-mobile-link">Dispatches</a>
    <span class="nav-mobile-link nav-mobile-link-disabled">
      Library
      <span class="soon-label">(soon)</span>
    </span>
    <a href="https://phronos.org/methods" class="nav-mobile-link">Methods</a>
    <a href="/" class="nav-mobile-link nav-mobile-link-active">Instruments</a>
  </div>

  <NavAuthButton client:load variant="mobile" />
</div>

<script>
  function initNav() {
    const hamburger = document.querySelector('.nav-hamburger');
    const mobileMenu = document.querySelector('.nav-mobile-menu');
    const closeBtn = document.querySelector('.nav-mobile-close');

    hamburger?.addEventListener('click', () => {
      mobileMenu?.classList.add('is-open');
      document.body.style.overflow = 'hidden';
    });

    closeBtn?.addEventListener('click', () => {
      mobileMenu?.classList.remove('is-open');
      document.body.style.overflow = '';
    });

    // Close menu when clicking a link
    const mobileLinks = document.querySelectorAll('.nav-mobile-link:not(.nav-mobile-link-disabled)');
    mobileLinks.forEach((link) => {
      link.addEventListener('click', () => {
        mobileMenu?.classList.remove('is-open');
        document.body.style.overflow = '';
      });
    });
  }

  initNav();
  document.addEventListener('astro:after-swap', initNav);
</script>

<style>
  /*
   * LandingNav-specific styles only.
   * Core navigation styles are in components.css
   */

  /* Subscribe button (landing page specific) */
  .nav-subscribe {
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--bg-deep);
    background: var(--gold);
    border: 1px solid var(--gold);
    padding: 0.5rem 1rem;
    cursor: pointer;
    transition: all var(--transition-default);
    text-decoration: none;
  }

  .nav-subscribe:hover {
    box-shadow: var(--shadow-button-hover);
    transform: translate(-2px, -2px);
  }

  .nav-mobile-subscribe {
    margin-top: auto;
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--bg-deep);
    background: var(--gold);
    border: 1px solid var(--gold);
    padding: var(--space-md);
    text-align: center;
    text-decoration: none;
    display: block;
    cursor: pointer;
    transition: all var(--transition-default);
  }

  .nav-mobile-subscribe:hover {
    box-shadow: var(--shadow-button-hover);
    transform: translate(-2px, -2px);
  }

  /* Auth User Display */
  .nav-auth-user {
    display: flex;
    align-items: center;
  }

  .nav-auth-email {
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    color: var(--text-light);
    max-width: 180px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .nav-mobile-auth-user {
    margin-top: auto;
    padding: var(--space-md);
    text-align: center;
    border-top: 1px solid var(--faded-light);
  }

  .nav-mobile-auth-email {
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    color: var(--text-light);
  }

  /* Profile link styles */
  .nav-profile-link {
    text-decoration: none;
    transition: color var(--transition-fast);
  }

  .nav-profile-link:hover {
    color: var(--gold);
  }

  /* Hide desktop subscribe on mobile */
  @media (max-width: 767px) {
    .nav-subscribe-desktop {
      display: none;
    }
  }
</style>
