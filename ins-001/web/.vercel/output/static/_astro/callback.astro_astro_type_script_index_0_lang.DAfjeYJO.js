import{s as d}from"./supabase.Dq7CRccX.js";const a=document.getElementById("status");function o(t,e=!1){a&&(a.textContent=t,e&&(a.style.color="var(--alert)"))}async function m(){try{const e=new URLSearchParams(window.location.search).get("returnTo")||"/",s=window.location.hash,r=new URLSearchParams(s.substring(1)),h=r.get("error"),i=r.get("error_description");if(h){const n=i?decodeURIComponent(i.replace(/\+/g," ")):"Authentication failed";o(n,!0),setTimeout(()=>{window.location.href=e},3e3);return}if(s&&s.includes("access_token")){const n=r.get("access_token"),l=r.get("refresh_token");if(n&&l){const{data:f,error:u}=await d.auth.setSession({access_token:n,refresh_token:l});if(u)throw u;if(f.session){o("Signed in successfully! Redirecting..."),window.history.replaceState(null,"",window.location.pathname),setTimeout(()=>{window.location.href=e},1500);return}}}const{data:{session:w},error:c}=await d.auth.getSession();if(c)throw c;w?(o("Signed in successfully! Redirecting..."),setTimeout(()=>{window.location.href=e},1500)):(o("Link expired or invalid. Redirecting...",!0),setTimeout(()=>{window.location.href=e},2e3))}catch(t){console.error("Auth callback error:",t);const e=t instanceof Error?t.message:"Unknown error";o(`Error: ${e}`,!0),setTimeout(()=>{window.location.href="/"},3e3)}}m().catch(t=>{console.error("Unhandled auth callback error:",t);const e=document.getElementById("status");e&&(e.textContent="Authentication error. Redirecting...",e.style.color="var(--alert)"),setTimeout(()=>{window.location.href="/"},2e3)});
