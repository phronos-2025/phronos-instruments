import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.WFquGv8Z.js";import{s as y}from"./supabase.Dq7CRccX.js";import{P as f,B as o}from"./Button.D4eF3GIc.js";const k=({isOpen:u,onClose:s})=>{const[n,p]=r.useState(""),[a,l]=r.useState(!1),[h,g]=r.useState(!1),[c,d]=r.useState(null);if(!u)return null;const x=async i=>{i.preventDefault(),l(!0),d(null);try{const t=window.location.pathname,{error:m}=await y.auth.signInWithOtp({email:n,options:{emailRedirectTo:`${window.location.origin}/auth/callback?returnTo=${encodeURIComponent(t)}`}});if(m)throw m;g(!0)}catch(t){d(t instanceof Error?t.message:"Failed to send magic link")}finally{l(!1)}};return e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"2rem"},children:e.jsx("div",{style:{maxWidth:"500px",width:"100%"},children:e.jsx(f,{title:"Initialize ID",children:h?e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:"1rem",color:"var(--faded)"},children:"Check your email for a magic link to convert your anonymous account to a registered account."}),e.jsx("div",{className:"btn-group",children:e.jsx(o,{variant:"primary",onClick:s,children:"Close"})})]}):e.jsxs("form",{onSubmit:x,children:[e.jsx("p",{style:{marginBottom:"1rem",color:"var(--faded)"},children:"Convert your anonymous account to a registered account to save your profile."}),e.jsx("input",{type:"email",value:n,onChange:i=>p(i.target.value),placeholder:"your@email.com",className:"clue-input",style:{width:"100%",marginBottom:"1rem"},required:!0,disabled:a}),c&&e.jsxs("div",{style:{color:"var(--alert)",marginBottom:"1rem",fontSize:"var(--text-sm)"},children:["â—ˆ ",c]}),e.jsxs("div",{className:"btn-group",children:[e.jsx(o,{type:"submit",variant:"primary",disabled:!n||a,children:a?"Sending...":"Send Magic Link"}),e.jsx(o,{type:"button",variant:"ghost",onClick:s,children:"Cancel"})]})]})})})})};export{k as M};
